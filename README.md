# コミケ混雑モニター

コミケ会場の混雑状況をリアルタイムで把握するためのPWAアプリケーション。

## 機能

### 入場者向け（PWA）
- 📍 位置情報の送信（30秒間隔）
- 🔔 プライバシーに配慮した匿名化
- 📱 ホーム画面への追加（PWA）
- 🔋 バッテリー消費を抑えた設計

### 運営向けダッシュボード
- 🗺️ 会場全体のヒートマップ表示
- 📊 エリアごとの混雑度・滞留率表示
- 🚨 滞留アラートのリアルタイム通知
- 📈 混雑傾向（増加/安定/減少）の表示

## 技術スタック

- **フレームワーク**: Nuxt 4（互換モード）
- **言語**: TypeScript
- **PWA**: @vite-pwa/nuxt
- **スタイリング**: CSS Variables + カスタムCSS
- **サーバー**: Nitro（Nuxt内蔵）

## セットアップ

```bash
# 依存関係のインストール
npm install

# 開発サーバーの起動
npm run dev

# ビルド
npm run build

# プレビュー
npm run preview
```

## ページ構成

| パス | 説明 |
|------|------|
| `/` | 入場者向けPWA（位置情報送信） |
| `/admin` | 運営向けダッシュボード |

## API

| エンドポイント | メソッド | 説明 |
|---------------|---------|------|
| `/api/location` | POST | 位置情報の送信 |
| `/api/crowd-status` | GET | 混雑状況の取得 |

## 設定

`nuxt.config.ts` で以下の設定が可能：

```ts
runtimeConfig: {
  public: {
    locationInterval: 30000,      // 位置情報送信間隔（ms）
    stagnationThreshold: 5,       // 滞留判定時間（分）
  },
}
```

## 本番環境での注意点

1. **データベース**: 本実装ではインメモリストアを使用。本番ではRedis + PostgreSQLを推奨
2. **WebSocket**: より低遅延が必要な場合はWebSocket/SSEに切り替え
3. **座標データ**: `server/utils/areas.ts` のエリア座標を実際の会場に合わせて調整
4. **プライバシー**: 個人情報保護方針の策定と同意フローの強化

## ライセンス

MIT
